!function(e){e.waitForImages={hasImageProperties:["backgroundImage","listStyleImage","borderImage","borderCornerImage"]},e.expr[":"].uncached=function(r){if(!e(r).is('img[src!=""]'))return!1;var n=new Image;return n.src=r.src,!n.complete},e.fn.waitForImages=function(r,n,a){var i=0,c=0;if(e.isPlainObject(arguments[0])&&(r=arguments[0].finished,n=arguments[0].each,a=arguments[0].waitForAll),r=r||e.noop,n=n||e.noop,a=!!a,!e.isFunction(r)||!e.isFunction(n))throw new TypeError("An invalid callback was supplied.");return this.each(function(){var t=e(this),s=[],o=e.waitForImages.hasImageProperties||[],u=/url\(\s*(['"]?)(.*?)\1\s*\)/g;a?t.find("*").andSelf().each(function(){var r=e(this);r.is("img:uncached")&&s.push({src:r.attr("src"),element:r[0]}),e.each(o,function(e,n){var a,i=r.css(n);if(!i)return!0;for(;a=u.exec(i);)s.push({src:a[2],element:r[0]})})}):t.find("img:uncached").each(function(){s.push({src:this.src,element:this})}),i=s.length,c=0,0===i&&r.call(t[0]),e.each(s,function(a,s){var o=new Image;e(o).bind("load.waitForImages error.waitForImages",function(e){if(c++,n.call(s.element,c,i,"load"==e.type),c==i)return r.call(t[0]),!1}),o.src=s.src})})}}(jQuery);